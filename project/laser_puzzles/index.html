<html lang="en">
<head>
  <title>grady.dev | Laser Cut Puzzles</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <meta name="viewport" content="width=device-width">
<style>

body {
  margin: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  font-family: Helvetica, sans-serif;
  line-height: 1.5rem;
}

h1 {
  font-size: 3rem;
  text-align: left;
  margin: 4rem 0 0rem 0;
  line-height: 3rem;
}

h4 {
  font-size: 1.5rem;
  text-align: left;
  margin: 1rem 0;
}

img {
  max-width: 100%;
}

.width-wrapper {
  width: Calc(100% - 2rem);
  max-width: 1000px;
  min-width: Calc(320px - 2rem);
  margin: 0 1rem 1rem 1rem;
  display: inline-block;
  position: relative;
  height: Calc(100% - 1rem);
}

.decorated-box {
  height:  auto;
  position:  relative;
}

.decorated-content {
  width:  Calc(100% - 16rem);
  top: 0;
  margin: 0rem 8rem 0;
  padding:  1rem 0 2rem 0;
  text-align: left;
  font-size: 1.5rem;
  line-height: 2.25rem;
}

.vertical {
  position: absolute;
  height: Calc(100% - 1rem);
  width: 8rem;
  top: 0;
}
.left.vertical {
  left:  0;
}
.right.vertical {
  right:  0;
}

.horizontal {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 1rem;
}
.horizontal > div {
  width:  100%;
}

* {
  color: #272727;
}

.black {
  background: #272727;
}

.red {
  background: #d20909;
}

.yellow {
  background: #eac40a;
}

.blue {
  background: #1444b1;
}

.black,
.red,
.blue,
.yellow {
  display: block;
  position: absolute;
  width: 1rem;
  height: 1rem;
  transition: width .5s linear, height .5s linear;
}

.vertical > div {
  height: Calc(100% - 1rem);
  top: .5rem;
}

.vertical > div.has-top {
  top: -1rem;
  height: Calc(100% + .5rem);
}

.vertical > div.has-bottom {
  top: .5rem;
  height: Calc(100% + .5rem);
}

.vertical > div.has-bottom.has-top {
  top: -1rem;
  height: Calc(100% + 2rem);
}

.pos-0 { left: 0rem; }
.pos-1 { left: 2rem; }
.pos-2 { left: 4rem; }
.pos-3 { left: 6rem; }
.pos-4 { right: 6rem; }
.pos-5 { right: 4rem; }
.pos-6 { right: 2rem; }
.pos-7 { right: 0rem; }


.from-0 { left: 1rem; }
.from-1 { left: 3rem; }
.from-2 { left: 5rem; }
.from-3 { left: 7rem; }
.from-4 { right: 7rem; }
.from-5 { right: 5rem; }
.from-6 { right: 3rem; }
.from-7 { right: 1rem; }

.from-3.to-4,
.from-4.to-3 {
    width: Calc(100% - 14rem);
}

.from-2.to-4,
.from-3.to-5,
.from-4.to-2,
.from-5.to-3 {
    width: Calc(100% - 12rem);
}

.from-1.to-4,
.from-2.to-5,
.from-3.to-6,
.from-4.to-1,
.from-5.to-2,
.from-6.to-3 {
    width: Calc(100% - 10rem);
}

.from-0.to-4,
.from-1.to-5,
.from-2.to-6,
.from-3.to-7,
.from-4.to-0,
.from-5.to-1,
.from-6.to-2,
.from-7.to-3 {
    width: Calc(100% - 8rem);
}

.from-0.to-5,
.from-1.to-6,
.from-2.to-7,
.from-5.to-0,
.from-6.to-1,
.from-7.to-2 {
    width: Calc(100% - 6rem);
}

.from-0.to-6,
.from-1.to-7,
.from-6.to-0,
.from-7.to-1 {
    width: Calc(100% - 4rem);
}

.from-0.to-7,
.from-7.to-0 {
    width: Calc(100% - 2rem);
}


.sr-only {
  position:absolute;
  left:-10000px;
  top:auto;
  width:1px;
  height:1px;
  overflow:hidden;
}

@media only screen and (max-width: 800px) {
  html {
    font-size: 8px;
  }

  .decorated-content {
    font-size: 2.5rem;
    line-height: 3rem;
  }

  h4 {
      font-size: 3rem;
  }

  h1 {
      font-size: 5rem;
      line-height:  6rem;
  }
}

@media only screen and (max-width: 500px) {
  html {
    font-size: 6px;
  }

  .decorated-content {
    font-size: 3rem;
    line-height: 3.5rem;
  }
}

@media only screen and (max-width: 360px) {
  .decorated-content {
    font-size: 2.5rem;
    line-height: 3rem;
  }
}


   


</style>
<body>
<div class="sr-only"><a href="#main">Skip to content</a></div>
<div class="width-wrapper pre-transition" id="width-wrapper">
<header class="decorated-box">
  <div aria-hidden="true" class="left vertical"></div>
  <div class="decorated-content">
    <nav><a href="..">Back</a></nav>
    <h1> Laser Cut Puzzles</h1>
  </div>
  <div aria-hidden="true" class="right vertical"></div>
  <div aria-hidden="true" class="horizontal"></div>
</header>

<main id="main">



  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        One of my best friends in the world - Brandon - got married in the summer of
2024, and insisted that no gifts would be exchanged. I nagged him ceaslessly
on this point, and he eventually relented that only gifts of creative,
rather than financial value would be accepted. Game on.
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        After much deliberation, I decided to make them a puzzle. I&rsquo;d been looking
for the opportunity to learn how to use a laser cutter, and thankfully both
Boulder + Denver offer the tools in their makerspaces. Over the course of
several months (and gifts for several close friends - celebrating a wedding,
comiserating about the passing of a beloved dog, etc.), I fine tuned both the
code for generating the puzzle, and the usage of the lazer cutters (trying
out three different kinds over time, and finding the right set of controls
for each).
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        <img src="/img/laser_partial.jpg" alt="A laser cutter cutting out a puzzle of a photo in memorial of a close friend&rsquo;s dog">
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        <img src="/img/laser_detail.jpg" alt="A small section of said puzzle, demonstrating the quality of the print from the GlowForge">
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        In the end I was very impressed by the Glowforge PRO, which consistently had
the lowest amount of hassle, and produced consistently good rasters. The
Epilog lazer I used for the final cut was also quite good both in precision
and accuracy in the cut,but the raster left quite a bit to be desired.
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        The final process I found to be effective involved first etching the image on
to the wood in a purely raster pass, and then doing the final cut only once
masked with masking tape, which prevented burn scars.
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        <img src="/img/laser_mask.jpg" alt="The final cut, using masking tape to prevent burn scars">
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        The primary challenge of this project was scooping up the tool
appointments at each library as it became available - they were hot commodities
and I often needed to plan my days to keep free the half hour when I knew
the appointments would go online.
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        Fine tuning the code was another tricky part, since there were
a lot of things to tweak, and very slow iteration cycles for trying them
out in the real world. I eventually figured out a structure for the nubs that
would cut well, and designed a cool algorithm for making the sides and curves
generally smooth, while not doing a full grid like a standard puzzle.
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        <img src="/img/laser_cut.svg" alt="An example cutting pattern generated by the code">
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        By the end, the code was capable of taking in an internal and external cut,
so that hidden shapes could be included in the puzzle. In this test cut
you can clearly see the &ldquo;4&rdquo; and the heart, a reference to the date of the marriage.
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        <img src="/img/laser_test.jpg" alt="An example of the inset pattern available in the final result">
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        I gave them the final result at their wedding, and they completed it
during a subsequent bout of COVID - ultimately framing it on their wall.
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        <img src="/img/laser_assembled.jpg" alt="The completed final result">
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        <img src="/img/laser_framed.jpg" alt="The framed final result">
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        (A piece was lost from the leftmost edge - a standard foible of the genre)
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  


  
    <div class="decorated-box">
      <div aria-hidden="true" class="left vertical"></div>
      <div class="decorated-content">
        This project was a great reminder for me that the best gifts are about
the thought behind them and the expression of care for the other people.
Building this gave me ample opportunities to reflect on how much both of
the people meant to me, and how thankful I was to have the time and skills to
tinker.
      </div>
      <div aria-hidden="true" class="right vertical"></div>
      <div aria-hidden="true" class="horizontal"></div>
    </div>
  

</main>

<div aria-hidden="true" class="decorated-box">
  <div class="left vertical"></div>
  <p class="decorated-content">
  </p>
  <div class="right vertical"></div>
  <div class="horizontal"></div>
</div>
</div>
<script>
  var wrapper = document.getElementById("width-wrapper");
  wrapper.classList.remove("pre-transition");

  var EMPTY = "empty";

  function randomInitialAssignment() {
    return ["red", "black", "yellow", "blue", EMPTY, EMPTY, EMPTY, EMPTY]
  }

  function couldSwapPair(assignment, from, to) {
    if (from < 4 == to < 4){
      return false;
    }
    if (assignment[to] != EMPTY || assignment[from] == EMPTY) {
      return false;
    }
    return true;
  }

  function randomPairToSwap(assignment) {
    var fromIndexOfPopulated = Math.floor(4 * Math.random());
    var fromIndex = -1;
    for (var i = 0; i < 8; i++) {
      if (assignment[i] != EMPTY) {
        if (fromIndexOfPopulated == 0) {
          fromIndex = i;
          break;
        }
        fromIndexOfPopulated--;
      }
    }
    var numEmptyOnOtherSide = 0;
    var otherSideStart = fromIndex < 4 ? 4 : 0;
    for (var i = 0; i < 4; i++) {
      if (assignment[i + otherSideStart] == EMPTY) {
        numEmptyOnOtherSide++;
      }
    }
    var toIndexOnOtherSideOfPopulated = Math.floor(numEmptyOnOtherSide * Math.random());
    var toIndex = -1;
    for (var i = otherSideStart; i < otherSideStart + 4; i++) {
      if (assignment[i] == EMPTY) {
        if (toIndexOnOtherSideOfPopulated == 0) {
          toIndex = i;
          break;
        }
        toIndexOnOtherSideOfPopulated--;
      }
    }
    return {
      "origin": fromIndex,
      "destination": toIndex
    };
  }

  function createParagraphAssignments(numParagraphs) {
    var paragraphAssignments = [];
    paragraphAssignments[0] = randomInitialAssignment();
    for (var i = 1; i < numParagraphs; i++) {
      var pairToSwap = randomPairToSwap(paragraphAssignments[i-1]);
      var newAssignment = [];
      Object.assign(newAssignment, paragraphAssignments[i-1]);
      newAssignment[pairToSwap.destination] = newAssignment[pairToSwap.origin];
      newAssignment[pairToSwap.origin] = EMPTY;
      newAssignment.origin = pairToSwap.origin;
      newAssignment.destination = pairToSwap.destination;
      paragraphAssignments.push(newAssignment);
    }
    for (var i = 0; i < numParagraphs - 1; i++) {
      paragraphAssignments[i].origin = paragraphAssignments[i+1].origin;
      paragraphAssignments[i].destination = paragraphAssignments[i+1].destination;
    }
    paragraphAssignments[numParagraphs-1].origin = -1;
    paragraphAssignments[numParagraphs-1].destination = -1;

    return paragraphAssignments;
  }

  function isInBetween(a, b, c){
    return ((a < b) == (b < c));
  }

  function assignAssignmentToParagraphBox(lastAssignment, assignment, box) {

    var bottomSidebar = box.getElementsByClassName('horizontal')[0];
    var classesForBottom = assignment[assignment.origin] + " from-" + assignment.origin + " to-" + assignment.destination;
    var bottomSidebarHtml = "<div class=\"" + classesForBottom + "\"></div>";
    bottomSidebar.innerHTML = bottomSidebarHtml;

    var leftSidebarHtml = "";
    for (var i = 0; i < 4; i++) {
      if (assignment[i] !== EMPTY) {
        var classesToAdd = assignment[i] + " pos-" + i;
        if (!isInBetween(lastAssignment.origin, i, lastAssignment.destination) || lastAssignment.destination == i){
          classesToAdd = classesToAdd + " has-top";
        }
        if (!isInBetween(assignment.origin, i, assignment.destination) || assignment.origin == i){
          classesToAdd = classesToAdd + " has-bottom";
        }
        leftSidebarHtml = leftSidebarHtml + '<div class="' +classesToAdd + '"></div>';
      }
    }
    var leftSidebar = box.getElementsByClassName('left')[0];
    leftSidebar.innerHTML = leftSidebarHtml;

    var rightSidebarHtml = "";
    for (var i = 4; i < 8; i++) {
      if (assignment[i] !== EMPTY) {
        var classesToAdd = assignment[i] + " pos-" + i;
        if (!isInBetween(lastAssignment.origin, i, lastAssignment.destination) || lastAssignment.destination == i){
          classesToAdd = classesToAdd + " has-top";
        }
        if (!isInBetween(assignment.origin, i, assignment.destination) || assignment.origin == i){
          classesToAdd = classesToAdd + " has-bottom";
        }
        rightSidebarHtml = rightSidebarHtml + '<div class="' +classesToAdd + '"></div>';
      }
    }
    var rightSidebar = box.getElementsByClassName('right')[0];
    rightSidebar.innerHTML = rightSidebarHtml;
  }

  var paragraphsBoxes = document.getElementsByClassName("decorated-box");
  var paragraphAssignments = createParagraphAssignments(paragraphsBoxes.length);
  console.log(paragraphAssignments);

  for (var i = 0; i < paragraphsBoxes.length; i++){
    var previous = {origin: -1, destination: -1};
    if (i > 0) {
      previous = paragraphAssignments[i - 1];
    }
    assignAssignmentToParagraphBox(previous, paragraphAssignments[i], paragraphsBoxes[i]);
  }
</script>
</body>
</html>
